<div class="blog-embed-card content-embed-card">
  {% if include.src %}
    <!-- VIDEO MODE -->
    {% assign is_local_video = false %}
    {% if include.src contains '.mp4' or include.src contains '.webm' or include.src contains '.ogg' %}
      {% unless include.src contains 'youtube.com' or include.src contains 'vimeo.com' or include.src contains 'http://' or include.src contains 'https://' %}
        {% assign is_local_video = true %}
      {% endunless %}
    {% endif %}
    
    <a href="{{ include.url | default: include.src }}" class="blog-embed-link-wrapper content-embed-link-wrapper">
      <div class="blog-embed-video-container">
        <div class="blog-embed-video-wrapper content-embed-video-wrapper">
          {% if is_local_video %}
          <video
            class="video-embed-minimal content-embed-iframe"
            src="{{ include.src }}"
            controls
            preload="none"
            {% if include.img %}poster="{{ include.img }}"{% endif %}
          ></video>
          {% else %}
            {% if include.img %}
            <!-- Custom thumbnail for iframe embeds -->
            <div class="content-embed-thumbnail-wrapper" onclick="this.style.display='none'; var iframe=this.nextElementSibling; iframe.src=iframe.dataset.src; return false;" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; cursor: pointer; background-color: #000; z-index: 1; display: flex; align-items: center; justify-content: center; flex-direction: column;">
              <img src="{{ include.img }}" alt="{{ include.title | escape }}" style="width: 100%; height: auto; flex-shrink: 0;" loading="lazy">
              <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 68px; height: 48px; background-color: rgba(255,0,0,0.8); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                <div style="width: 0; height: 0; border-left: 18px solid white; border-top: 12px solid transparent; border-bottom: 12px solid transparent; margin-left: 4px;"></div>
              </div>
            </div>
            <iframe
              class="video-embed-minimal content-embed-iframe"
              data-src="{{ include.src }}"
              src=""
              title="{{ include.title | escape }}"
              allowfullscreen
              loading="lazy"
              referrerpolicy="strict-origin-when-cross-origin"
            ></iframe>
            {% else %}
            <iframe
              class="video-embed-minimal content-embed-iframe"
              src="{{ include.src }}"
              title="{{ include.title | escape }}"
              allowfullscreen
              loading="lazy"
              referrerpolicy="strict-origin-when-cross-origin"
            ></iframe>
            {% endif %}
          {% endif %}
        </div>
      </div>
      <div class="blog-embed-meta content-embed-meta">
        {% if include.title %}
          <div class="blog-embed-title content-embed-title">
            <span class="no-auto-link-marker">{{ include.title }}</span>
          </div>
        {% endif %}
        {% if include.author or include.date %}
          <div class="content-embed-metadata content-embed-metadata-mb">
            {% if include.author %}by {% assign matched_person = nil %}{% for person in site.people %}{% if person.name == include.author %}{% assign matched_person = person %}{% break %}{% endif %}{% endfor %}{% if matched_person %}<a href="{{ matched_person.url }}" class="blog-embed-author content-embed-author-link">{{ include.author }}</a>{% else %}<span class="blog-embed-author">{{ include.author }}</span>{% endif %}{% endif %}{% if include.date %}{% if include.author %}, {% endif %}<span class="blog-embed-date">{{ include.date | date: "%B %d, %Y" }}</span>{% endif %}
          </div>
        {% endif %}
      </div>
    </a>
  {% else %}
    <!-- BLOG MODE -->
    {% if include.img or include.title %}
      <a href="{{ include.url }}" target="_blank" rel="noopener" class="blog-embed-link-wrapper">
        {% if include.img %}
          <div class="blog-embed-image-container">
            <img src="{{ include.img }}" alt="{{ include.alt | default: include.url }}" class="blog-embed-image" loading="lazy" />
          </div>
        {% endif %}
        {% if include.title %}
          <div class="blog-embed-title-with-padding">
            {{ include.title }}
          </div>
        {% endif %}
      </a>
    {% endif %}
    <div class="blog-embed-meta">
      {% if include.description %}
        <div class="blog-embed-description content-embed-description">
          {{ include.description }}
        </div>
      {% endif %}
      {% if include.site %}
        <div class="blog-embed-site-line content-embed-metadata-mb">
          {% if include.site contains "http" %}
            <a href="{{ include.site }}" target="_blank" rel="noopener" class="content-embed-site-link">{{ include.site }}</a>
          {% else %}
            {{ include.site }}
          {% endif %}
        </div>
        {% if include.author or include.date %}
        <div class="content-embed-metadata-mb">
          {% assign matched_person = nil %}
          {% for person in site.people %}
            {% if person.name == include.author %}
              {% assign matched_person = person %}
              {% break %}
            {% endif %}
          {% endfor %}
          {% if matched_person %}
            by <a href="{{ matched_person.url }}" class="blog-embed-author content-embed-author-link">{{ include.author }}</a>
            {% if include.date %}, <span class="blog-embed-date">{{ include.date | date: "%B %d, %Y" }}</span>{% endif %}
          {% elsif include.author %}
            by <span class="blog-embed-author">{{ include.author }}</span>
            {% if include.date %}, <span class="blog-embed-date">{{ include.date | date: "%B %d, %Y" }}</span>{% endif %}
          {% elsif include.date %}
            <span class="blog-embed-date">{{ include.date | date: "%B %d, %Y" }}</span>
          {% endif %}
        </div>
        {% endif %}
      {% elsif include.author or include.date %}
        <div class="content-embed-metadata-mb">
          {% if include.author %}by {% assign matched_person = nil %}{% for person in site.people %}{% if person.name == include.author %}{% assign matched_person = person %}{% break %}{% endif %}{% endfor %}{% if matched_person %}<a href="{{ matched_person.url }}" class="blog-embed-author content-embed-author-link">{{ include.author }}</a>{% else %}<span class="blog-embed-author">{{ include.author }}</span>{% endif %}{% endif %}{% if include.date %}{% if include.author %}, {% endif %}<span class="blog-embed-date">{{ include.date | date: "%B %d, %Y" }}</span>{% endif %}
        </div>
      {% endif %}
    </div>
  {% endif %}
</div>
